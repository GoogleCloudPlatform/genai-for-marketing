# Terraform deployment

## Prerequisites:

### Enable Firebase

1. Go to https://console.firebase.google.com/
2. Select add project and load your Google Cloud Platform project
3. Add Firebase to one of your existing Google Cloud projects
4. Confirm Firebase billing plan
5. Continue and complete

### Enable Vertex AI Agent Builder

1. Go to https://console.cloud.google.com/gen-app-builder/start
2. Accept TOS

### Add service account key

1. Add Owner Role to service account
2. Create key
3. Download key and rename it as "tf/svc_acc.json"

### Create GCS bucket

1. Create bucket
2. Save bucket ID as "asset_bkt" in config.toml.tftpl

## Terraform deployment

```
export USER_PROJECT_OVERRIDE=true
export GOOGLE_BILLING_PROJECT=<your_project_id>

terraform init

terraform apply -var=project_id=<your_project_id>
```

## After Terraform deployment

1. Go to https://firebase.corp.google.com/project/genai-marketing-tf-test/authentication/providers
2. Select Google and enable it
3. Set the name for the project and support email for project
4. Save
5. Enable Firestore in production mode with request.auth != null as rules.
6. Add Bigquery, Storage and Firebase Admin roles to the service account generated by Terraform
7. Share your Templated Google Docs and Drive folder with the forementioned service account
8. Be on the watch for bugs and errors as this version is not stable yet!

## TODO

- Deploy Dialogflow agent in Terraform
- Solve venv activation issues
- Create bucket through Terraform
- Solve a sea of bugs
